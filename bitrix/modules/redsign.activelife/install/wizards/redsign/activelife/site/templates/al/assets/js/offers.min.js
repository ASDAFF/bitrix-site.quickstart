appSLine.offerPropChangedTimeout=0,appSLine.catalogElementSetPrice=function(e,a){var r=e.find(".js-price_pdv-"+a.PRICE_ID);r&&(parseFloat(a.DISCOUNT_DIFF)>0?r.closest(".price").addClass("price-disc"):r.closest(".price").removeClass("price-disc"),r.html(a.PRINT_DISCOUNT_VALUE));var i=e.find(".js-price_pdd-"+a.PRICE_ID);i&&(parseFloat(a.DISCOUNT_DIFF>0)?i.html(a.PRINT_DISCOUNT):i.html(""));var t=e.find(".js-price_pv-"+a.PRICE_ID);t&&(parseFloat(a.DISCOUNT_DIFF)>0?t.html(a.PRINT_VALUE):t.html(""))},appSLine.catalogElementSetPriceMatrix=function(e,a){var r=e.find(".js-quantity").val();for(var i in a.ROWS)if((0==a.ROWS[i].QUANTITY_FROM||a.ROWS[i].QUANTITY_FROM<=r)&&(0==a.ROWS[i].QUANTITY_TO||a.ROWS[i].QUANTITY_TO>=r)){for(var t in a.COLS)a.MATRIX[t][i]&&this.catalogElementSetPrice(e,{PRICE_ID:a.COLS[t].ID,PRINT_DISCOUNT_VALUE:a.MATRIX[t][i].PRINT_DISCOUNT_VALUE,PRINT_DISCOUNT:a.MATRIX[t][i].PRINT_DISCOUNT_DIFF,PRINT_VALUE:a.MATRIX[t][i].PRINT_VALUE,DISCOUNT_DIFF:a.MATRIX[t][i].DISCOUNT_DIFF});break}},appSLine.offerPropChanged=function(e){var a=e.closest(".js-product"),r=a.data("product-id"),i=e.closest(".js-offer_prop"),t=i.data("code");e.data("value");if(appSLine.offers[r]&&!e.hasClass("disabled")){i.find(".offer_prop__value").removeClass("checked"),e.addClass("checked"),i.find(".offer_prop__checked").text(e.text());var o="",s="",n=new Object;for(var f in appSLine.offers[r].SORT_PROPS)if(s=appSLine.offers[r].SORT_PROPS[f],n[s]=a.find('.offer_prop[data-code="'+s+'"]').find(".offer_prop__value.checked").data("value"),s==t){o=!!appSLine.offers[r].SORT_PROPS[parseInt(f)+1]&&appSLine.offers[r].SORT_PROPS[parseInt(f)+1];break}if(o){var _=!0,d=new Array;for(var l in appSLine.offers[r].OFFERS){_=!0;e:for(var p in n)if(n[p]!=appSLine.offers[r].OFFERS[l].PROPERTIES[p]){_=!1;break e}_&&d.push(appSLine.offers[r].OFFERS[l].PROPERTIES[o])}var S=a.find('.offer_prop[data-code="'+o+'"]');S.find(".offer_prop__value").each(function(e){var a=$(this),r=!0;for(var i in d)if(a.data("value")==d[i]){r=!1;break}a.addClass("disabled"),r||a.removeClass("disabled")}),S.find(".offer_prop__value.checked").hasClass("disabled")?$nextOption=S.find(".offer_prop__value:not(.disabled):first"):$nextOption=S.find(".offer_prop__value.checked"),this.offerPropChanged($nextOption)}else this.catalogElementChangeOffer(a)}},appSLine.catalogElementChangeOffer=function(e){function a(e,a,r){return e=parseInt(e),a=parseInt(a),0==e?r[0]:e>=a?r[2]:r[1]}var r=e.data("product-id"),i=appSLine.offers[r];if(i){var t={};e.find(".offer_prop__value.checked").each(function(e){var a=$(this),r=a.closest(".js-offer_prop").data("code"),i=a.data("value");t[r]=i});var o=0,s=!0;for(var n in i.OFFERS){s=!0;for(var f in t)if(t[f]!=i.OFFERS[n].PROPERTIES[f]){s=!1;break}if(s){o=n;break}}if(void 0==i.OFFERS[o])return!1;var _=i.OFFERS[o];if(e.data("offer-id",o),e.find(".js-product_id").val(o),void 0!=_.DETAIL_PAGE_URL&&e.find(".js-product__name,        .catalog_item__detail,        .catalog_item__zoom,        .catalog_item__pic").attr("href",_.DETAIL_PAGE_URL),void 0!=_.IMAGES){var d=e.find(".picbox__carousel"),l=d.data("owl.carousel");if(d.length>0){var p=l.settings.smartSpeed,S="";for(var c in _.IMAGES)if("p"!=c){var T='<a class="picbox__canvas js_picture_glass" data-offer-id="'+o+"\" data-dot=\"<img class='owl-preview' src='"+_.IMAGES[c].smaller+'\'>">                <img class="picbox__img" src="'+_.IMAGES[c].big+'" data-large="'+_.IMAGES[c].original+'"/>              </a>';"d"==c?S=T+S:S+=T}for(var c in l._items){var E=l._items[c].children("a");1!=E.length||E.attr("data-offer-id")||(S+=l._items[c].html())}l._plugins.navigation._templates=[],l._plugins.navigation._controls.$absolute.html(""),l.settings.smartSpeed=0,d.trigger("replace.owl.carousel",[S]),setTimeout(function(){d.trigger("refresh.owl.carousel").trigger("to.owl.carousel",[0])},250),l.settings.smartSpeed=p}else{var A=["p","d",0];for(var c in A)if(void 0!=_.IMAGES[A[c]]){e.find(".catalog_item__img").attr("src",_.IMAGES[A[c]].small);break}}}if(void 0!=_.DISPLAY_PROPERTIES)for(var I in _.DISPLAY_PROPERTIES){var R=e.find(".sku_prop__val_"+I);R.length&&(R.html(_.DISPLAY_PROPERTIES[I].DISPLAY_VALUE),""==_.DISPLAY_PROPERTIES[I].DISPLAY_VALUE?(R.prev(".sku_prop__name").hide(),R.parent(".sku_prop").hide()):(R.prev(".sku_prop__name").show(),R.parent(".sku_prop").show()))}if(_.CATALOG_MEASURE_NAME&&e.find(".js-measure").html(_.CATALOG_MEASURE_NAME),_.CATALOG_MEASURE_RATIO&&e.find(".js-quantity").data("ratio",_.CATALOG_MEASURE_RATIO).attr("step",_.CATALOG_MEASURE_RATIO).attr("min",_.CATALOG_MEASURE_RATIO).val(_.CATALOG_MEASURE_RATIO),_.PRICE_MATRIX)this.catalogElementSetPriceMatrix(e,_.PRICE_MATRIX);else if(_.PRICES)for(var O in _.PRICES)this.catalogElementSetPrice(e,_.PRICES[O]);$timers=e.removeClass("qb da2").find(".js_timer, .rs_progress-wrap").hide(),i.ELEMENT.DAYSARTICLE2||_.DAYSARTICLE2?(e.addClass("da2"),$timers.filter('[data-offer-id="'+r+'"]').length>0?$timers.filter('[data-offer-id="'+r+'"]').show():$timers.filter('[data-offer-id="'+o+'"]').length>0&&$timers.filter('[data-offer-id="'+o+'"]').show()):(i.ELEMENT.QUICKBUY||_.QUICKBUY)&&(e.addClass("qb"),$timers.filter('[data-offer-id="'+r+'"]').length>0?$timers.filter('[data-offer-id="'+r+'"]').show():$timers.filter('[data-offer-id="'+o+'"]').length>0&&$timers.filter('[data-offer-id="'+o+'"]').show()),_.CAN_BUY?(e.find(".js-add2cart, .js-buy1click").removeClass("disabled"),i.ELEMENT.CATALOG_SUBSCRIBE&&e.find(".js-subscribe").hide()):(e.find(".js-add2cart, .js-buy1click").addClass("disabled"),i.ELEMENT.CATALOG_SUBSCRIBE&&e.find(".js-subscribe").attr("data-item",o).show());var v=e.find(".stocks");if(v.length){var m=["is-outofstock","is-limited","is-instock"];if(this.offers[r].PARAMS.USE_STORE&&void 0!=this.stocks[r]){var u=this.stocks[r],L=[u.MESSAGES.OUT_OF_STOCK,u.MESSAGES.LIMITED_AVAILABILITY,u.MESSAGES.IN_STOCK];v.find(".stocks__amount").text(u.USE_MIN_AMOUNT?a(u.SKU[o].TOTAL_AMOUNT,u.MIN_AMOUNT,L):u.SKU[o].TOTAL_AMOUNT);var h=v.find(".stocks__scale").removeClass("is-outofstock is-limited is-instock").addClass(a(u.SKU[o].TOTAL_AMOUNT,u.MIN_AMOUNT,m));0==u.SKU[o].MAX_AMOUNT?h.children(".scale__over").removeAttr("style"):h.children(".scale__over").css("width","100%");for(c in u.STORES){var C=v.find("#"+u.ID+"_"+u.STORES[c]);if(!u.SHOW_EMPTY_STORE&&u.SKU[o].STORES[u.STORES[c]]<=0)C.hide();else{C.find(".stock__quantity").text(u.USE_MIN_AMOUNT?a(u.SKU[o].STORES[u.STORES[c]],u.MIN_AMOUNT,L):u.SKU[o].STORES[u.STORES[c]]);var h=C.show().find(".stock__scale").removeClass("is-outofstock is-limited is-instock").addClass(a(u.SKU[o].STORES[u.STORES[c]],u.MIN_AMOUNT,m));0==u.SKU[o].MAX_AMOUNT?h.children(".scale__over").removeAttr("style"):h.children(".scale__over").css("width",100*u.SKU[o].STORES[u.STORES[c]]/u.SKU[o].MAX_AMOUNT+"%")}}}else{var L=[BX.message("RS_SLINE_STOCK_OUT_OF_STOCK"),BX.message("RS_SLINE_STOCK_LIMITED_AVAILABILITY"),BX.message("RS_SLINE_STOCK_IN_STOCK")];v.find(".stocks__amount").text(i.PARAMS.USE_MIN_AMOUNT?a(_.CATALOG_QUANTITY,i.PARAMS.MIN_AMOUNT,L):_.CATALOG_QUANTITY);var h=v.find(".stocks__scale").removeClass("is-outofstock is-limited is-instock").addClass(a(_.CATALOG_QUANTITY,i.PARAMS.MIN_AMOUNT,m));0==_.CATALOG_QUANTITY?h.children(".scale__over").removeAttr("style"):h.find(".scale__over").css("width","100%")}}this.setProductItems({items:e}),$.fancybox.toggle()}},$(document).on("click",".js-product .js-offer_prop .offer_prop__value",function(e){var a=$(this);if(!a.hasClass("disabled")&&!a.hasClass("checked")){var r=a.closest(".js-product"),i=parseInt(r.data("product-id"));a.closest(".js-offer_prop");if(i>0)if(clearTimeout(appSLine.offerPropChangedTimeout),appSLine.offers[i])appSLine.offerPropChanged(a);else{var t=r.find(".js-product__name").attr("href"),o=r.children(".catalog_item__inner");void 0==t&&(t=void 0==r.data("detail")?window.location.href:r.data("detail")),o.length<1&&(o=r),o.rsToggleDark({progress:!0}),appSLine.offerPropChangedTimeout=setTimeout(function(){$.ajax({type:"POST",url:t,dataType:"json",data:{AJAX_CALL:"Y",action:"get_element_json"},success:function(e){appSLine.offers[i]=e,appSLine.offerPropChanged(a)},error:function(e,a,r){console.error(e.status),console.error(r)},complete:function(){o.rsToggleDark()}})},appSLine.ajaxTimeoutTime)}}}),$(document).on("change",".js-product .js-quantity.js-use_count",function(e){var a=$(this);if(!a.hasClass("disabled")){var r=a.closest(".js-product"),i=parseInt(r.data("product-id"));if(i>0)if(clearTimeout(appSLine.offerPropChangedTimeout),e.stopPropagation(),appSLine.offers[i]){var t=r.find(".js-product_id").val();void 0!=appSLine.offers[i].OFFERS[t]&&void 0!=appSLine.offers[i].OFFERS[t].PRICE_MATRIX?appSLine.catalogElementSetPriceMatrix(r,appSLine.offers[i].OFFERS[t].PRICE_MATRIX):void 0!=appSLine.offers[i].ELEMENT.PRICE_MATRIX&&appSLine.catalogElementSetPriceMatrix(r,appSLine.offers[i].ELEMENT.PRICE_MATRIX)}else{var o=r.find(".js-product__name").attr("href"),s=r.children(".catalog_item__inner");void 0==o&&(o=void 0==r.data("detail")?window.location.href:r.data("detail")),s.length<1&&(s=r),s.rsToggleDark({progress:!0}),appSLine.offerPropChangedTimeout=setTimeout(function(){$.ajax({type:"POST",url:o,dataType:"json",data:{AJAX_CALL:"Y",action:"get_element_json"},success:function(e){appSLine.offers[i]=e;var a=r.find(".js-product_id").val();appSLine.offers[i]&&(void 0!=appSLine.offers[i].OFFERS[a]&&void 0!=appSLine.offers[i].OFFERS[a].PRICE_MATRIX?appSLine.catalogElementSetPriceMatrix(r,appSLine.offers[i].OFFERS[a].PRICE_MATRIX):void 0!=appSLine.offers[i].ELEMENT.PRICE_MATRIX&&appSLine.catalogElementSetPriceMatrix(r,appSLine.offers[i].ELEMENT.PRICE_MATRIX))},error:function(){console.error(xhr.status),console.error(thrownError)},complete:function(){s.rsToggleDark()}})},appSLine.ajaxTimeoutTime)}else console.error("Get element JSON -> iProductID is empty")}return!1});